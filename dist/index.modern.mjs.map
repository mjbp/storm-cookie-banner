{"version":3,"file":"index.modern.mjs","sources":["../src/lib/constants.js","../src/lib/utils.js","../src/lib/defaults.js","../src/lib/reducers.js","../src/lib/consent.js","../src/lib/ui.js","../src/index.js","../src/lib/factory.js","../src/lib/store.js"],"sourcesContent":["export const TRIGGER_EVENTS = window.PointerEvent ? ['pointerup', 'keydown'] : ['ontouchstart' in window ? 'touchstart' : 'click', 'keydown' ];\n\nexport const TRIGGER_KEYCODES = [13, 32];","import { TRIGGER_KEYCODES } from './constants';\n\n//Modernizr cookie test\nexport const cookiesEnabled = () => {\n    try {\n        document.cookie = 'cookietest=1';\n        const ret = document.cookie.indexOf('cookietest=') !== -1;\n        document.cookie = 'cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT';\n        return ret;\n      }\n      catch (e) {\n        return false;\n      }\n};\n\nexport const writeCookie = state => {\n    document.cookie = [\n        `${state.settings.name}=${JSON.stringify(state.consent)};`,\n        `expires=${(new Date(new Date().getTime() + (state.settings.expiry*24*60*60*1000))).toGMTString()};`,\n        state.settings.path ? `path=${state.settings.path};` : '',\n        state.settings.domain ? `domain=${state.settings.domain};` : '',\n        state.settings.secure ? `secure;` : ''\n    ].join('');\n}\n\nexport const readCookie = settings => {\n    const cookie = document.cookie.split('; ').map(part => ({ name: part.split('=')[0], value: part.split('=')[1] })).filter(part => part.name === settings.name)[0];\n    return cookie !== undefined ? cookie : false;\n};\n\nconst updateCookie = state => model => document.cookie = [\n    `${model.name}=${model.value};`,\n    `expires=${model.expiry};`,\n    `path=${state.settings.path};`,\n    state.settings.domain ? `domain=${state.settings.domain};` : '',\n    state.settings.secure ? `secure` : ''\n].join('');\n\nexport const deleteCookies = state => {\n    document.cookie\n        .split('; ')\n        .map(part => ({ \n            name: part.split('=')[0],\n            value: part.split('=')[1],\n            expiry: 'Thu, 01 Jan 1970 00:00:01 GMT'\n        }))\n        .map(updateCookie(state));\n};\n\nexport const shouldReturn = e => (!!e.keyCode && !~TRIGGER_KEYCODES.indexOf(e.keyCode) || (e.which && e.which === 3));\n\nexport const composeTypes = opts => (acc, curr) => {\n    if(acc[curr]) {\n        acc[curr] = Object.assign({}, acc[curr], {\n            fns: acc[curr].fns.concat(opts.types[curr].fns),\n        });\n    }  else acc[curr] = opts.types[curr];\n    return acc;\n};\n\nexport const noop = () => {};\n\nexport const isCheckable = field => (/radio|checkbox/i).test(field.type);\n\nconst hasValue = input => (input.value !== undefined && input.value !== null && input.value.length > 0);\n\nexport const groupValueReducer = (acc, input) => {\n    if(!isCheckable(input) && hasValue(input)) acc = input.value;\n    if(isCheckable(input) && input.checked) {\n        if(Array.isArray(acc)) acc.push(input.value)\n        else acc = [input.value];\n    }\n    return acc;\n};\n\nconst firstTLDs  = \"ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|be|bf|bg|bh|bi|bj|bm|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|cl|cm|cn|co|cr|cu|cv|cw|cx|cz|de|dj|dk|dm|do|dz|ec|ee|eg|es|et|eu|fi|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|im|in|io|iq|ir|is|it|je|jo|jp|kg|ki|km|kn|kp|kr|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|na|nc|ne|nf|ng|nl|no|nr|nu|nz|om|pa|pe|pf|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|yt\".split('|');\nconst secondTLDs = \"azurewebsites|com|edu|gov|net|mil|org|nom|sch|caa|res|off|gob|int|tur|ip6|uri|urn|asn|act|nsw|qld|tas|vic|pro|biz|adm|adv|agr|arq|art|ato|bio|bmd|cim|cng|cnt|ecn|eco|emp|eng|esp|etc|eti|far|fnd|fot|fst|g12|ggf|imb|ind|inf|jor|jus|leg|lel|mat|med|mus|not|ntr|odo|ppg|psc|psi|qsl|rec|slg|srv|teo|tmp|trd|vet|zlg|web|ltd|sld|pol|fin|k12|lib|pri|aip|fie|eun|sci|prd|cci|pvt|mod|idv|rel|sex|gen|nic|abr|bas|cal|cam|emr|fvg|laz|lig|lom|mar|mol|pmn|pug|sar|sic|taa|tos|umb|vao|vda|ven|mie|北海道|和歌山|神奈川|鹿児島|ass|rep|tra|per|ngo|soc|grp|plc|its|air|and|bus|can|ddr|jfk|mad|nrw|nyc|ski|spy|tcm|ulm|usa|war|fhs|vgs|dep|eid|fet|fla|flå|gol|hof|hol|sel|vik|cri|iwi|ing|abo|fam|gok|gon|gop|gos|aid|atm|gsm|sos|elk|waw|est|aca|bar|cpa|jur|law|sec|plo|www|bir|cbg|jar|khv|msk|nov|nsk|ptz|rnd|spb|stv|tom|tsk|udm|vrn|cmw|kms|nkz|snz|pub|fhv|red|ens|nat|rns|rnu|bbs|tel|bel|kep|nhs|dni|fed|isa|nsn|gub|e12|tec|орг|обр|упр|alt|nis|jpn|mex|ath|iki|nid|gda|inc\".split('|');\n\nexport const removeSubdomain = s => {\n    s = s.replace(/^www\\./, '');\n    let parts = s.split('.');\n    \n    while (parts.length > 3) {\n        parts.shift();\n    }\n\n    if (parts.length === 3 && ((secondTLDs.indexOf(parts[1]) === -1) && firstTLDs.indexOf(parts[2]) === -1)) {\n        parts.shift();\n    }\n\n    return parts.join('.');\n};\n","import { removeSubdomain } from './utils'; \n\nexport default {\n\tname: '.CookiePreferences',\n\tpath: '',\n\tdomain: window.location.hostname === 'localhost' ? '' : `.${removeSubdomain(window.location.hostname)}`,\n\tsecure: true,\n\texpiry: 365,\n\ttypes: {},\n\tnecessary: [],\n\tbannerTrigger: false,\n\tpolicyURL: '/cookie-policy',\n\tclassNames: {\n\t\tbanner: 'privacy-banner',\n\t\tacceptBtn: 'privacy-banner__accept',\n\t\tsubmitBtn: 'privacy-banner__submit',\n\t\tfield: 'privacy-banner__field',\n\t\tform: 'privacy-banner__form',\n\t\tfieldset: 'privacy-banner__fieldset',\n\t\tlegend: 'privacy-banner__legend',\n\t\tformContainer: 'privacy-banner__form-container',\n\t\tformMessage: 'privacy-banner__form-msg',\n\t\ttitle: 'privacy-banner__form-title',\n\t\tdescription: 'privacy-banner__form-description'\n\t},\n\tsavedMessage: 'Your settings have been saved.',\n\tbannerTemplate(model){\n\t\treturn `<section role=\"dialog\" aria-live=\"polite\" aria-label=\"You privacy\" class=\"${model.classNames.banner}\">\n\t\t\t<div class=\"privacy-content\">\n\t\t\t\t<div class=\"wrap\">\n\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t<!--googleoff: all-->\n\t\t\t\t\t\t<div class=\"privacy-banner__title\">Cookies</div>\n\t\t\t\t\t\t<p>We use cookies to improve your experience on our site and show you personalised advertising.</p>\n\t\t\t\t\t\t<p>Find out more from our <a class=\"privacy-banner__link\" rel=\"noopener noreferrer nofollow\" href=\"/privacy-policy\">privacy policy</a> and <a class=\"privacy-banner__link\" rel=\"noopener noreferrer nofollow\" href=\"${model.policyURL}\">cookie policy</a>.</p>\n\t\t\t\t\t\t<button class=\"btn btn--primary ${model.classNames.acceptBtn}\">Accept and close</button>\n\t\t\t\t\t\t<a class=\"privacy-banner__link\" rel=\"noopener noreferrer nofollow\" href=\"${model.policyURL}\">Your options</a>\n\t\t\t\t\t\t<!--googleon: all-->\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</section>`;\n\t},\n\tmessageTemplate(model){\n\t\treturn `<div class=\"${model.settings.classNames.formMessage}\" aria-role=\"alert\">${model.settings.savedMessage}</div>`\n\t},\n\tformTemplate(model){\n\t\treturn `<form class=\"${model.settings.classNames.form}\" novalidate>\n\t\t\t\t${Object.keys(model.settings.types).map(type => `<fieldset class=\"${model.settings.classNames.fieldset}\">\n\t\t\t\t<legend class=\"${model.settings.classNames.legend}\">\n\t\t\t\t\t<span class=\"${model.settings.classNames.title}\">${model.settings.types[type].title}</span>\n\t\t\t\t\t<span class=\"${model.settings.classNames.description}\">${model.settings.types[type].description}</span>\n\t\t\t\t</legend>\n\t\t\t\t<div class=\"form-row\">\n\t\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t\t<label class=\"privacy-banner__label\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"${model.settings.classNames.field}\"\n\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\tname=\"privacy-${type.split(' ')[0].replace(' ', '-')}\"\n\t\t\t\t\t\t\t\tvalue=\"1\"\n\t\t\t\t\t\t\t\t${model.consent[type] === 1 ? ` checked` : ''}>\n\t\t\t\t\t\t\t<span class=\"privacy-banner__label-text\">I am OK with this</span>\n\t\t\t\t\t\t\t<span class=\"privacy-banner__label-description\">${model.settings.types[type].labels.yes}</span>\n\t\t\t\t\t\t</label>    \n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-row\">\n\t\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t\t<label class=\"privacy-banner__label\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"${model.settings.classNames.field}\"\n\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\tname=\"privacy-${type.split(' ')[0].replace(' ', '-')}\"\n\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t${model.consent[type] === 0 ? ` checked` : ''}>\n\t\t\t\t\t\t\t<span class=\"privacy-banner__label-text\">No thank you</span>\n\t\t\t\t\t\t\t<span class=\"privacy-banner__label-description\">${model.settings.types[type].labels.no}</span>\n\t\t\t\t\t\t</label>    \n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</fieldset>`).join('')}\n\t\t\t<button class=\"${model.settings.classNames.submitBtn}\"${Object.keys(model.consent).length === 0 ? ` disabled` : ''}>Save my settings</button>\n\t\t</form>`;\n\t}\n};","export const initialState = (state, data) => Object.assign({}, state, data);\nexport const updateConsent = (state, data) => Object.assign({}, state, { consent: Object.assign({}, state.consent, data)});\nexport const updateExecuted = (state, data) => Object.assign({}, state, { settings: Object.assign({}, state.settings, { types: Object.assign({}, state.settings.types, data) })});","import { updateExecuted } from './reducers';\n\nexport const apply = Store => state => {\n    Object.keys(state.consent).forEach(key => {\n        if(state.settings.types[key].executed === true) return;\n        if(state.consent[key] && Boolean(state.consent[key])) {\n            state.settings.types[key].fns.forEach(fn => fn(state));\n        }\n    });\n    Store.update(updateExecuted, Object.keys(state.settings.types).reduce((acc, type) => {\n        acc[type] = Object.assign({}, state.settings.types[type], { executed: state.settings.types[type].executed || (state.consent[type] && Boolean(state.consent[type])) });\n        return acc;\n    }, {}));\n};\n\nexport const necessary = state => {\n    state.settings.necessary.forEach(fn => fn(state));\n};\n\n","import { shouldReturn, writeCookie, groupValueReducer, deleteCookies } from './utils';\nimport { TRIGGER_EVENTS } from './constants';\nimport { apply } from './consent';\nimport { updateConsent } from './reducers';\n\nexport const initBanner = Store => state => {\n    document.body.firstElementChild.insertAdjacentHTML('beforebegin', state.settings.bannerTemplate(state.settings));\n    const banner = document.querySelector(`.${state.settings.classNames.banner}`);\n    const acceptBtn = document.querySelector(`.${state.settings.classNames.acceptBtn}`);\n\n    TRIGGER_EVENTS.forEach(ev => {\n        acceptBtn.addEventListener(ev, e => {\n            if (shouldReturn(e)) return;\n\n            Store.update(\n                updateConsent,\n                Object.keys(state.settings.types).reduce((acc, type) => {\n                    acc[type] = 1;\n                    return acc;\n                }, {}),\n                [\n                    writeCookie,\n                    apply(Store),\n                    removeBanner(banner),\n                    initForm(Store)\n                ]\n            );\n        });\n    });\n};\n\nconst removeBanner = banner => () => (banner && banner.parentNode) && banner.parentNode.removeChild(banner);\n\nconst suggestedConsent = state => Object.keys(state.consent).length > 0\n    ? state\n    : Object.assign({}, state, {\n        consent: Object.keys(state.settings.types).reduce((acc, type) => {\n            if (state.settings.types[type].suggested) acc[type] = 1;\n            return acc;\n        }, {})\n    });\n\nexport const initForm = Store => state => {\n    const formContainer = document.querySelector(`.${state.settings.classNames.formContainer}`);\n    if (!formContainer) return;\n\n    formContainer.innerHTML = state.settings.formTemplate(suggestedConsent(state));\n\n    const form = document.querySelector(`.${state.settings.classNames.form}`);\n    const banner = document.querySelector(`.${state.settings.classNames.banner}`);\n    const button = document.querySelector(`.${state.settings.classNames.submitBtn}`);\n    const groups = [].slice.call(document.querySelectorAll(`.${state.settings.classNames.field}`)).reduce((groups, field) => {\n        const groupName = field.getAttribute('name').replace('privacy-', '');\n        if (groups[groupName]) groups[groupName].push(field);\n        else groups[groupName] = [field];\n        return groups;\n    }, {});\n\n    const extractConsent = () => Object.keys(groups).reduce((acc, key) => {\n        const value = groups[key].reduce(groupValueReducer, '');\n        if (value) acc[key] = parseInt(value);\n        return acc;\n    }, {});\n\n    const enableButton = e => {\n        if (Object.keys(extractConsent()).length !== Object.keys(groups).length) return;\n        button.removeAttribute('disabled');\n        form.removeEventListener('change', enableButton);\n    };\n    button.hasAttribute('disabled') && form.addEventListener('change', enableButton);\n\n    form.addEventListener('submit', e => {\n        e.preventDefault();\n        Store.update(\n            updateConsent,\n            extractConsent(),\n            [\n                deleteCookies,\n                writeCookie,\n                apply(Store),\n                removeBanner(banner),\n                renderMessage(button)\n            ]\n        );\n    });\n};\n\nexport const renderMessage = button => state => {\n    button.insertAdjacentHTML('afterend', state.settings.messageTemplate(state));\n    button.setAttribute('disabled', 'disabled');\n    window.setTimeout(() => {\n        button.parentNode.removeChild(button.nextElementSibling);\n        button.removeAttribute('disabled');\n    }, 3000);\n};","import defaults from './lib/defaults';\nimport factory from './lib/factory';\nimport { composeTypes } from './lib/utils';\n\nexport default {\n    init: opts => factory(Object.assign({}, defaults, opts, {\n        types: Object.keys(opts.types).reduce(composeTypes(opts), defaults.types)\n    }))\n};","import { cookiesEnabled, readCookie, noop } from './utils';\nimport { initBanner, initForm } from './ui';\nimport { necessary, apply } from './consent';\nimport { createStore } from './store';\nimport { initialState } from './reducers';\n\nexport default settings => {\n    if(!cookiesEnabled()) return;\n    \n    const Store = createStore();\n    const cookies = readCookie(settings);\n    Store.update(\n        initialState,\n        { settings, consent: cookies ? JSON.parse(cookies.value) : { } },\n        [ necessary, apply(Store), cookies ? noop : initBanner(Store), initForm(Store) ]\n    );\n\n    return { getState: Store.getState } ;\n};","export const createStore = () => {\n    //shared centralised validator state\n    let state = {};\n    \n    //state getter\n    const getState = () => state;\n\n    /**\n     * Create next state by invoking reducer on current state\n     * \n     * Execute side effects of state update, as passed in the update\n     * \n     * @param reducer [Function] \n     * @param nextState [Object] New slice of state to combine with current state to create next state\n     * @param effects [Array] Array of side effect functions to invoke after state update (DOM, operations, cmds...)\n     */\n    const update = function(reducer, nextState, effects) {\n        state =  reducer(state, nextState);\n        // console.log(state);\n        if(!effects) return;\n        effects.forEach(effect => { effect(state); });\n    };\n\n    return { update, getState };\n};"],"names":["const","TRIGGER_EVENTS","window","PointerEvent","TRIGGER_KEYCODES","writeCookie","state","document","cookie","settings","JSON","stringify","consent","Date","getTime","expiry","toGMTString","path","domain","secure","join","deleteCookies","split","map","part","name","value","model","updateCookie","composeTypes","opts","acc","curr","Object","assign","fns","concat","types","noop","isCheckable","field","test","type","groupValueReducer","input","length","hasValue","checked","Array","isArray","push","firstTLDs","secondTLDs","location","hostname","s","parts","replace","shift","indexOf","necessary","bannerTrigger","policyURL","classNames","banner","acceptBtn","submitBtn","form","fieldset","legend","formContainer","formMessage","title","description","savedMessage","bannerTemplate","messageTemplate","formTemplate","keys","labels","initialState","data","updateConsent","updateExecuted","apply","Store","forEach","key","executed","Boolean","fn","update","reduce","initBanner","body","firstElementChild","insertAdjacentHTML","querySelector","ev","addEventListener","e","keyCode","which","shouldReturn","removeBanner","initForm","parentNode","removeChild","innerHTML","suggested","suggestedConsent","button","groups","slice","call","querySelectorAll","groupName","getAttribute","extractConsent","parseInt","enableButton","removeAttribute","removeEventListener","hasAttribute","preventDefault","renderMessage","setAttribute","setTimeout","nextElementSibling","init","ret","cookiesEnabled","reducer","nextState","effects","effect","cookies","filter","undefined","readCookie","parse","getState","factory","defaults"],"mappings":"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"}